body {
    font-family: Arial, sans-serif;
    color: #fff;
    margin: 0;
    background-color: #000;
    overflow: hidden;
    height: 100vh;
}

#game-wrapper {
    width: 1280px;
    height: 720px;
    position: absolute;
    overflow: hidden;
    background-image: url('images/mapas/cenarios externos/externo (1).png');
    background-size: cover;
    background-position: center;
    transform-origin: top left;
}

.screen {
    display: none;
    width: 100%;
    height: 100%;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
.screen.active {
    display: flex;
}
.hidden { display: none !important; }

#loading-screen, #gm-initial-lobby, #player-waiting-screen, #gm-party-setup-screen, #selection-screen, #role-selection-screen {
    background-color: rgba(0, 0, 0, 0.9);
    gap: 20px;
    text-align: center;
    padding: 20px;
    box-sizing: border-box;
}

#gm-npc-setup-screen {
    background-color: rgba(0, 0, 0, 0.9);
    padding: 20px;
    box-sizing: border-box;
    justify-content: flex-start; /* Alinha o conteúdo no topo */
}

#fight-screen {
    background-color: transparent; 
    padding: 0;
    justify-content: normal;
    align-items: normal;
    position: relative;
    pointer-events: none; 
}
#theater-screen {
    padding: 0;
    justify-content: normal;
    align-items: normal;
    position: relative;
    background-color: #222; 
}
#fight-screen.active, #theater-screen.active {
    display: block;
}

h1 { font-size: 3.5em; color: #ffeb3b; text-shadow: 2px 2px 5px #000; margin-bottom: 20px; }
#gm-npc-setup-screen h1 { font-size: 2em; margin-bottom: 5px; margin-top: 0; }
#gm-npc-setup-screen p { margin-top: 0; margin-bottom: 15px; }

.gm-links-container { display: flex; gap: 30px; justify-content: center; margin-bottom: 20px; flex-wrap: wrap; width: 90%; max-width: 1100px; }
.gm-links-container > div {
    background-color: rgba(0, 0, 0, 0.3);
    padding: 15px;
    border-radius: 8px;
    flex: 1; 
    min-width: 400px;
}
.share-link { background-color: #fff; color: #000; padding: 10px 20px; font-family: monospace; font-size: 1.2em; border-radius: 5px; cursor: pointer; margin-top: 10px; border: 2px dashed #ffeb3b; display: inline-block; word-break: break-all; }
#gm-lobby-status-container { background-color: rgba(255, 255, 255, 0.1); border-radius: 8px; padding: 15px; width: 90%; max-width: 1100px; max-height: 180px; overflow-y: auto; }
#gm-lobby-status-container h3 { margin-top: 0; color: #ffeb3b; }
#gm-lobby-player-list { list-style: none; padding: 0; margin: 0; font-size: 1.2em; text-align: left; }
#player-waiting-message { font-size: 1.8em; color: #ccc; }
.mode-buttons-container { display: flex; gap: 20px; }
.mode-btn { padding: 20px 40px; font-size: 1.5em; cursor: pointer; border: 2px solid #ffeb3b; border-radius: 10px; background-color: #333; color: #ffeb3b; transition: all 0.2s ease-in-out; }
.mode-btn:hover { background-color: #ffeb3b; color: #000; transform: scale(1.05); }

#character-list-container, .party-list-container { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; padding: 20px; max-height: 450px; overflow-y: auto; width: 90%; }

.char-card, .party-member-card, .npc-card { background-color: #333; border: 3px solid #555; border-radius: 10px; padding: 15px; text-align: center; transition: all 0.2s ease-in-out; width: 150px; position: relative; cursor: pointer; }
.char-card:hover, .npc-card:hover { border-color: #aaa; }
.char-card.selected { border-color: #ffeb3b; box-shadow: 0 0 15px #ffeb3b; transform: scale(1.05); }
.char-card.disabled, .npc-card.disabled { cursor: not-allowed; opacity: 0.6; }
.char-card.disabled img { filter: grayscale(100%); }
.char-unavailable-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); border-radius: 7px; display: flex; justify-content: center; align-items: center; color: #dc3545; font-size: 1.5em; font-weight: bold; text-shadow: 1px 1px 2px black; }
.char-card img, .party-member-card img, .npc-card img { width: 80px; height: 80px; object-fit: contain; background-color: #222; border-radius: 50%; margin-bottom: 10px; }
.char-card .char-name, .party-member-card h4, .npc-card .char-name { font-size: 1.2em; font-weight: bold; }
.party-member-card label, .npc-card label { display: block; margin: 5px 0; font-size: 0.9em; }
.party-member-card input, .npc-card input { width: 50px; text-align: center; font-size: 1em; background: #555; color: #fff; border: 1px solid #777; border-radius: 4px; }

#confirm-selection-btn { margin-top: 20px; padding: 15px 35px; font-size: 1.3em; cursor: pointer; border: 2px solid #ffeb3b; border-radius: 10px; background-color: #333; color: #ffeb3b; transition: all 0.2s ease-in-out; }
#confirm-selection-btn:hover:not(:disabled) { background-color: #ffeb3b; color: #000; }
#confirm-selection-btn:disabled { background-color: #495057; color: #aaa; cursor: not-allowed; border-color: #6c757d; }
#gm-start-battle-btn { margin-top: 20px; }


/* --- LAYOUT DE SELEÇÃO DE NPCS --- */
.npc-setup-layout { display: flex; flex-direction: row; gap: 20px; width: 95%; height: calc(100% - 150px); }
#npc-staging-area-container { width: 180px; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; display: flex; flex-direction: column; flex-shrink: 0; }
#npc-staging-area-container h3 { margin: 0 0 10px 0; text-align: center; }
#npc-staging-area { display: flex; flex-direction: column; gap: 10px; align-items: center; }
.npc-slot { width: 100px; height: 100px; border: 2px dashed #555; border-radius: 8px; display: flex; justify-content: center; align-items: center; position: relative; transition: all 0.2s; background-color: rgba(255,255,255,0.02); }
.npc-slot.empty-slot { cursor: pointer; }
.npc-slot.empty-slot:hover { border-color: #aaa; background-color: rgba(255,255,255,0.05); }
.npc-slot.selected-slot { border-style: solid; border-color: #ffeb3b; box-shadow: 0 0 10px #ffeb3b; }
.npc-slot img { width: 100%; height: 100%; border-radius: 5px; object-fit: contain; }
.remove-staged-npc { position: absolute; top: -8px; right: -8px; background: #c82333; color: white; border: none; border-radius: 50%; width: 22px; height: 22px; font-weight: bold; cursor: pointer; line-height: 20px; z-index: 1; }

.npc-selection-wrapper { flex-grow: 1; display: flex; flex-direction: column; min-width: 0; }
#npc-selection-area { display: flex; flex-wrap: wrap; gap: 15px; align-content: flex-start; padding: 10px; flex-grow: 1; overflow-y: auto; width: 100%; border: 1px solid #444; border-radius: 8px; }

/* --- MODO CENÁRIO --- */
#theater-background-viewport{position:absolute;top:0;left:0;width:calc(100% - 250px);height:100%;z-index:1;transition:width .3s ease-in-out;overflow:hidden;cursor:grab;background-color:#333;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#theater-background-viewport.group-select-mode{cursor:crosshair}#theater-world-container{position:relative;transform-origin:0 0}#selection-box{position:absolute;border:1px dashed #ffeb3b;background-color:rgba(255,235,59,.2);z-index:9999;pointer-events:none;transform-origin:0 0}#theater-background-image{display:block;pointer-events:none;width:100%;height:100%;object-fit:cover}#theater-token-container{position:absolute;top:0;left:0;width:100%;height:100%;z-index:2;transform-style:preserve-3d;pointer-events:none}.theater-token{position:absolute;width:200px;height:auto;cursor:grab;-webkit-user-drag:none;pointer-events:all;transform-origin:center center;transition:opacity .3s,transform .1s,left 0s,top 0s}.theater-token:active{cursor:grabbing}.theater-token.selected{outline:3px dashed #ffeb3b;outline-offset:5px;border-radius:10px}#theater-gm-panel{position:absolute;top:0;right:0;width:250px;height:100%;background-color:rgba(0,0,0,.75);z-index:3;padding:15px;box-sizing:border-box;display:flex;flex-direction:column;gap:20px;color:#fff;overflow-y:auto;transition:right .3s ease-in-out}.panel-section{background-color:rgba(255,255,255,.1);padding:10px;border-radius:8px}#theater-char-list{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}.theater-char-mini{width:60px;height:60px;background-color:#333;border:2px solid #555;border-radius:5px;cursor:grab;background-size:contain;background-repeat:no-repeat;background-position:center}.theater-char-mini:hover{border-color:#ffeb3b}.theater-char-mini:active{cursor:grabbing}#theater-gm-panel h4{margin-top:0;margin-bottom:10px;text-align:center;color:#ffeb3b;border-bottom:1px solid #555;padding-bottom:5px}#theater-gm-panel label{display:block;margin-bottom:5px}#theater-gm-panel input[type=range]{width:100%}#theater-gm-panel button{width:100%;padding:10px;margin-top:15px;color:#fff;border:none;border-radius:5px;cursor:pointer}#theater-change-scenario-btn{background-color:#007bff}#theater-change-scenario-btn:hover{background-color:#0056b3}#theater-publish-btn{background-color:#28a745}#theater-publish-btn:hover{background-color:#218838}#theater-gm-legend p{font-size:.9em;margin:5px 0;color:#ccc}#theater-gm-legend b{color:#ffc107;display:inline-block;width:70px}.toggle-gm-panel-btn{position:absolute;top:0;right:250px;width:40px;height:40px;font-size:1.8em;background-color:rgba(0,0,0,.7);color:#ffeb3b;border:2px solid #ffeb3b;border-right:none;border-radius:8px 0 0 8px;cursor:pointer;z-index:4;display:flex;justify-content:center;align-items:center}#theater-screen.panel-hidden #theater-gm-panel{right:-250px}#theater-screen.panel-hidden #theater-background-viewport{width:100%}#theater-screen.panel-hidden .toggle-gm-panel-btn{right:0}

/* --- TELA DE LUTA --- */
#fight-scene-characters{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}
.char-positioner { position: absolute; width: 1px; height: 1px; }
.char-container{position:absolute; bottom: 0; left: 50%; transform: translateX(-50%); display:flex;flex-direction:column;align-items:center;width:150px;pointer-events:all;transition:transform .2s ease-out,left .5s ease-in-out,opacity 1.2s ease-in;transform-origin:bottom center; }
.char-container { transform: scale(var(--character-scale, 1)) translateX(-50%); }
.fighter-img-ingame{width:150px;height:150px;object-fit:contain;filter:drop-shadow(2px 2px 5px rgba(0,0,0,.7));transform-origin:bottom center}.health-bar-ingame{width:100px;height:15px;background-color:rgba(85,85,85,.7);border:1px solid #000;border-radius:5px;margin-bottom:5px;position:relative}.health-bar-ingame-fill{height:100%;background-color:#28a745;border-radius:5px;transition:width .5s ease-in-out}.health-bar-ingame-text{position:absolute;width:100%;text-align:center;top:-1px;font-size:.8em;font-weight:700;color:#fff;text-shadow:1px 1px 1px #000}.fighter-name-ingame{background-color:rgba(0,0,0,.6);padding:2px 8px;border-radius:5px;margin-top:5px;font-size:.9em;font-weight:700}.active-turn>.fighter-img-ingame{filter:drop-shadow(0 0 15px #ffeb3b)}.fighter-img-ingame.is-hit-flash{animation:hit-flash-effect .4s ease-out}@keyframes hit-flash-effect{0%,to{filter:brightness(1) drop-shadow(2px 2px 5px rgba(0,0,0,.7))}50%{filter:brightness(3) drop-shadow(2px 2px 5px hsla(0,0%,100%,.7))}}.animate-defeat-player{animation:defeat-grayscale-flash 1.2s forwards}@keyframes defeat-grayscale-flash{0%,40%,20%{filter:brightness(3)}10%,30%{filter:brightness(1)}to{filter:grayscale(1) brightness(.7)}}.player-defeated-final{filter:grayscale(1) brightness(.7)}.animate-defeat-npc{animation:defeat-fade-out 2s forwards}@keyframes defeat-fade-out{0%,20%{opacity:1;transform:scale(1.1)}10%,30%{opacity:.3;transform:scale(1)}40%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.5);pointer-events:none}}.npc-defeated-final{opacity:0;pointer-events:none}.is-fleeing-player{left:-300px!important;opacity:0}.is-fleeing-npc{left:1300px!important;opacity:0}#fight-log-container{position:absolute;top:20px;left:50%;transform:translateX(-50%);width:50%;max-width:600px;height:150px;background-color:rgba(0,0,0,.7);border:2px solid #555;border-radius:10px;padding:10px;display:flex;flex-direction:column;z-index:10;pointer-events:auto}#round-info{margin-top:0;text-align:center;border-bottom:1px solid #fff;padding-bottom:10px}#fight-log{overflow-y:auto;flex-grow:1;font-size:.9em}#fight-log p{margin:5px 0}.log-hit{color:#ffc107}.log-miss{color:#6c757d}.log-crit{color:#dc3545;font-weight:700}.log-info{color:#17a2b8}.log-turn{color:#fff;font-weight:700}.log-round{color:#ffeb3b;font-weight:700;text-align:center}.highlight-result{font-weight:700;font-size:1.25em;color:#ffeb3b}.turn-highlight{font-weight:700;color:#dc3545}#action-buttons-wrapper{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);display:flex;gap:15px;padding:15px;background-color:rgba(0,0,0,.7);border-radius:10px;z-index:10;pointer-events:auto}.action-btn,.end-turn-btn{padding:15px 25px;font-size:1.1em;cursor:pointer;border:none;border-radius:5px;color:#fff;transition:background-color .2s}.action-btn{background-color:#c82333}.action-btn:hover:not(:disabled){background-color:#a71d2a}.action-btn.flee-btn{background-color:#007bff}.action-btn.flee-btn:hover:not(:disabled){background-color:#0056b3}.end-turn-btn{background-color:#ffc107;color:#000}.action-btn:disabled,.end-turn-btn:disabled{background-color:#495057;color:#aaa;cursor:not-allowed;opacity:.7}#initiative-ui{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);display:flex;gap:20px;z-index:11;pointer-events:auto}.initiative-btn{padding:15px 30px;font-size:1.5em;font-weight:700;cursor:pointer;border:3px solid #ffeb3b;border-radius:10px;background-color:rgba(0,0,0,.7);color:#ffeb3b;text-shadow:1px 1px 2px #000}.initiative-btn:disabled{background-color:rgba(100,100,100,.7);color:#888;border-color:#888;cursor:not-allowed}.char-container.targetable{cursor:crosshair}.char-container.targetable .fighter-img-ingame:hover{filter:drop-shadow(0 0 20px #fff);transform:scale(1.1)}#targeting-indicator{position:absolute;bottom:120px;left:50%;transform:translateX(-50%);background-color:rgba(220,53,69,.9);color:#fff;padding:10px 25px;border-radius:8px;font-weight:700;z-index:100;pointer-events:none}
#coords-display{position:absolute;top:20px;left:20px;background-color:rgba(0,0,0,.8);color:#ffeb3b;padding:5px 10px;border-radius:5px;font-family:monospace;font-size:1.2em;z-index:9000;pointer-events:none;line-height:1.5}#turn-order-sidebar{position:absolute;top:20px;right:20px;width:100px;background-color:rgba(0,0,0,.6);border-radius:10px;border:2px solid #555;padding:10px;display:flex;flex-direction:column;gap:10px;z-index:5;max-height:calc(100% - 40px);overflow:hidden;pointer-events:auto}.turn-order-card{display:flex;flex-direction:column;align-items:center;transition:all .3s ease-in-out}.turn-order-card img{width:60px;height:60px;object-fit:contain;border-radius:50%;border:3px solid #888;background-color:#333;transition:all .3s ease-in-out}.turn-order-card.active-turn-indicator img{border-color:#ffeb3b;transform:scale(1.2);box-shadow:0 0 15px #ffeb3b}#waiting-players-sidebar{position:absolute;top:20px;left:140px;width:100px;background-color:rgba(0,0,0,.6);border-radius:10px;border:2px solid #17a2b8;padding:10px;display:flex;flex-direction:column;gap:10px;z-index:5;max-height:calc(100% - 40px);overflow:hidden;pointer-events:auto}.waiting-player-card{display:flex;flex-direction:column;align-items:center}.waiting-player-card.gm-clickable:hover{cursor:pointer}.waiting-player-card.gm-clickable:hover img{border-color:#28a745;box-shadow:0 0 10px #28a745}.waiting-player-card img{width:60px;height:60px;object-fit:contain;border-radius:5px;border:3px solid #888;background-color:#333;transition:all .3s ease-in-out}.waiting-player-card p{font-size:.8em;margin:5px 0 0;text-align:center}.back-btn{position:absolute;top:20px;left:20px;width:50px;height:50px;border-radius:50%;border:2px solid #ffeb3b;background-color:rgba(0,0,0,.7);color:#fff;font-size:24px;cursor:pointer;display:flex;justify-content:center;align-items:center;transition:all .2s ease-in-out;z-index:9000}.back-btn:hover{background-color:#ffeb3b;color:#000;transform:scale(1.1)}#floating-buttons-container{position:absolute;bottom:20px;right:20px;display:flex;flex-direction:column;gap:10px;z-index:9000}#floating-buttons-container button{width:50px;height:50px;border-radius:50%;border:2px solid #ffeb3b;background-color:rgba(0,0,0,.7);color:#fff;font-size:24px;cursor:pointer;display:flex;justify-content:center;align-items:center;transition:all .2s ease-in-out}#floating-buttons-container button:hover{background-color:#ffeb3b;color:#000;transform:scale(1.1)}
#modal{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.8);display:flex;justify-content:center;align-items:center;z-index:9999}#modal-content{background:#2b2b2b;padding:30px;border-radius:10px;text-align:center;border:2px solid #fff;min-width:400px;max-width:80%;max-height:80%;position:relative;display:flex;flex-direction:column}#modal-title{margin-top:0;font-size:1.5em}#modal-text{margin:15px 0;text-align:left;flex-grow:1;display:flex;flex-direction:column;overflow-y:auto}#modal-button{padding:10px 20px;font-size:1.1em;cursor:pointer;margin-top:15px;background-color:#28a745;color:#fff;border:none;border-radius:5px}.modal-button-container{display:flex;justify-content:center;gap:20px;margin-top:20px}.modal-button-container button{padding:10px 30px;font-size:1.1em;cursor:pointer;border-radius:5px;border:none}.modal-button-container button:first-child{background-color:#28a745;color:#fff}.modal-button-container button:last-child{background-color:#dc3545;color:#fff}
#modal-text .category-tabs{display:flex;gap:5px;flex-wrap:wrap;border-bottom:2px solid #555;padding-bottom:10px;margin-bottom:10px}.category-tab-btn{background-color:#555;color:#fff;padding:8px 15px;border:1px solid #777;border-radius:5px 5px 0 0;cursor:pointer;transition:background-color .2s;border-bottom:none}.category-tab-btn.active,.category-tab-btn:hover{background-color:#007bff}#modal-text .scenarios-grid{display:none;flex-wrap:wrap;gap:10px;justify-content:center}#modal-text .scenarios-grid.active{display:flex}.scenario-card{width:150px;background-color:#333;border:2px solid #555;border-radius:8px;overflow:hidden;cursor:pointer;transition:border-color .2s;display:flex;flex-direction:column}.scenario-card:hover{border-color:#ffeb3b}.scenario-card img{width:100%;height:100px;object-fit:cover}.scenario-card .scenario-name{font-size:.9em;padding:8px;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.multi-health-bar-container{display:flex;justify-content:center;gap:4px;margin-bottom:5px;width:150px;height:12px}.health-bar-ingame-part{flex-grow:1;height:100%;background-color:rgba(85,85,85,.7);border:1px solid #000;border-radius:3px;position:relative;overflow:hidden;cursor:help}.health-bar-ingame-part-fill{height:100%;background-color:#28a745;border-radius:2px;transition:width .5s ease-in-out}.health-bar-ingame-part.defeated .health-bar-ingame-part-fill{background-color:#dc3545}#modal-text .target-part-selection{display:flex;flex-direction:column;gap:15px;align-items:center;margin-top:15px}.target-part-btn{padding:12px 25px;font-size:1.1em;font-weight:700;cursor:pointer;border:2px solid #ffc107;border-radius:8px;background-color:#5a1a1f;color:#fff;transition:all .2s ease-in-out;width:80%;max-width:350px}.target-part-btn:hover:not(:disabled){background-color:#c82333;border-color:#ffeb3b;transform:scale(1.05)}.target-part-btn:disabled{background-color:#333;color:#888;border-color:#555;cursor:not-allowed}

/* === NOVOS ESTILOS PARA A FICHA DE PERSONAGEM (ALMARA RPG) === */

#player-initial-choice-screen{background-color:rgba(0,0,0,.9);gap:20px;text-align:center;padding:20px;box-sizing:border-box}
#character-sheet-screen{background-color:rgba(0,0,0,.95);justify-content:flex-start;padding:20px;box-sizing:border-box;overflow-y:auto}
.sheet-container{background-color:rgba(10,10,10,.8);border:2px solid #a18a59;border-radius:10px;width:95%;max-width:1100px;padding:20px;box-sizing:border-box;color:#e0e0e0;display:flex;flex-direction:column;gap:10px;font-family:'Georgia',serif;margin-bottom:20px}
.sheet-header h1{font-size:2.5em;color:#ffeb3b;text-align:center;margin:0 0 10px;padding-bottom:10px;border-bottom:1px solid #a18a59}.sheet-main-info{display:flex;justify-content:space-around;gap:20px;flex-wrap:wrap}.sheet-field{display:flex;flex-direction:column;gap:5px;flex-grow:1}.sheet-field label{font-size:1.1em;color:#ffc107}.sheet-field input,.sheet-field select{background-color:#222;border:1px solid #555;color:#fff;padding:8px;border-radius:4px;font-size:1em}.sheet-calculated-stats{display:flex;justify-content:space-around;gap:15px;background-color:rgba(0,0,0,.3);padding:10px;border-radius:8px}.stat-box{text-align:center;flex-grow:1}.stat-box h4{margin:0 0 5px;font-size:1em;color:#ccc;font-weight:400}.stat-box .stat-value{font-size:2em;font-weight:700;color:#ffeb3b}.sheet-columns{display:flex;gap:20px;flex:1;min-height:0}.sheet-column{flex:1;display:flex;flex-direction:column;gap:15px}.sheet-section{background-color:rgba(255,255,255,.05);border-radius:6px;padding:15px;border:1px solid #444}.sheet-section h3{margin:0 0 10px;color:#ffc107;border-bottom:1px solid #555;padding-bottom:5px;font-size:1.2em}.sheet-section h3 small{font-size:.8em;color:#ccc;font-weight:400}.life-bars{display:flex;gap:20px;justify-content:space-around}.bar-container{text-align:center}.bar-container label{display:block;font-size:1em;color:#ffc107}.bar-container .bar-value{font-size:1.5em;font-weight:700}.attributes-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}.elements-grid{grid-template-columns:repeat(3,1fr)}.attr-item{display:flex;flex-direction:column;align-items:center;gap:5px;background:rgba(0,0,0,.2);padding:5px;border-radius:4px}.attr-item label{font-size:.9em}.number-input-wrapper{display:flex;align-items:center;justify-content:center}.attr-item input{width:40px;text-align:center;font-size:1.2em;background:#333;color:#fff;border:1px solid #777;border-radius:4px;-moz-appearance:textfield}.attr-item input::-webkit-outer-spin-button,.attr-item input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}
.arrow-btn{background:#555;border:none;color:#fff;cursor:pointer;font-size:1.2em;width:20px;height:30px;line-height:30px;padding:0}.arrow-btn:hover:not(:disabled){background:#777}.arrow-btn.down-arrow{background-color:#c82333}.arrow-btn.down-arrow:hover:not(:disabled){background-color:#a71d2a}.arrow-btn.up-arrow{background-color:#28a745}.arrow-btn.up-arrow:hover:not(:disabled){background-color:#218838}.arrow-btn:disabled{background-color:#495057;color:#aaa;cursor:not-allowed}
.down-arrow{border-radius:4px 0 0 4px}.up-arrow{border-radius:0 4px 4px 0}.final-attributes .attr-item span{font-size:1.5em;font-weight:700;color:#fff}.info-box{background-color:rgba(0,0,0,.3);padding:10px;border-radius:4px;min-height:60px;font-size:.9em;line-height:1.4;overflow-y:auto}.info-text{font-size:.9em;color:#aaa;margin-top:10px;text-align:center;min-height:1.2em}#sheet-equipment-section h3{margin:0 0 10px;color:#ffc107;font-size:1.2em}.equipment-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px}.equip-item{display:flex;flex-direction:column;gap:5px}.equip-item label{font-size:1em;color:#ffc107}.equip-item input,.equip-item select{background-color:#222;border:1px solid #555;color:#fff;padding:8px;border-radius:4px;font-size:1em;width:100%;box-sizing:border-box}.money-container{text-align:center;font-size:1.2em;margin-top:15px;padding:8px;background-color:rgba(0,0,0,.4);border-radius:4px}.sheet-footer{display:flex;justify-content:flex-end;gap:20px;padding-top:15px;margin-top:10px;border-top:1px solid #a18a59}.sheet-btn{padding:10px 20px;font-size:1.2em;cursor:pointer;border-radius:8px;border:2px solid #a18a59;background-color:#3e321c;color:#ffeb3b;transition:all .2s}.sheet-btn:hover:not(:disabled){background-color:#a18a59;color:#000}.sheet-btn.confirm{background-color:#28a745;border-color:#1c7430;color:#fff}.sheet-btn.confirm:hover:not(:disabled){background-color:#218838}.sheet-btn:disabled{background-color:#495057;color:#aaa;cursor:not-allowed;border-color:#6c757d}
.error-message{color:#ff6b6b;font-size:.9em;margin-left:10px;font-style:italic}.advanced-element-display{font-size:.9em;color:#87ceeb;height:1.2em;margin-top:4px;font-style:italic;font-weight:700}#spell-selection-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:10px}.spell-card{background-color:rgba(0,0,0,.4);border:2px solid #555;padding:8px;border-radius:5px;cursor:pointer;transition:border-color .2s}.spell-card:hover{border-color:#aaa}.spell-card.selected{border-color:#ffeb3b;box-shadow:0 0 8px #ffeb3b}.spell-card h4{margin:0 0 5px;font-size:1em;color:#ffc107}.spell-card h4 small{font-size:0.8em; color: #ccc;}.spell-card p{font-size:.85em;margin:0;line-height:1.3;color:#ccc}


/* --- NOVOS ESTILOS (IMPLEMENTAÇÃO DO COMBATE) --- */

.npc-slot:not(.empty-slot) {
    cursor: pointer;
}

.mahou-bar-ingame {
    width: 100px;
    height: 10px;
    background-color: rgba(85, 85, 85, 0.7);
    border: 1px solid #000;
    border-radius: 5px;
    margin-top: 2px;
    position: relative;
}

.mahou-bar-ingame-fill {
    height: 100%;
    background-color: #007bff;
    border-radius: 5px;
    transition: width 0.5s ease-in-out;
}

.mahou-bar-ingame-text {
    position: absolute;
    width: 100%;
    text-align: center;
    top: -2px;
    font-size: .7em;
    font-weight: 700;
    color: #fff;
    text-shadow: 1px 1px 1px #000;
}


.action-btn.spell-btn {
    background-color: #6f42c1;
}
.action-btn.spell-btn:hover:not(:disabled) {
    background-color: #5a32a3;
}

.npc-config-container {
    display: flex;
    gap: 20px;
}
.npc-config-col {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 15px;
}
.npc-config-col h4 {
    margin: 0;
    color: #ffc107;
    border-bottom: 1px solid #555;
    padding-bottom: 5px;
}
.npc-config-grid {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 10px 15px;
    align-items: center;
}
.npc-config-grid.elements {
    grid-template-columns: auto 1fr auto 1fr;
}

.npc-config-grid label {
    text-align: right;
    font-weight: bold;
    color: #ccc;
}
.npc-config-grid input[type="number"] {
    width: 80px;
    padding: 5px;
    background-color: #333;
    color: #fff;
    border: 1px solid #777;
    border-radius: 4px;
    font-size: 1.1em;
}

.npc-config-equip {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 10px 15px;
    align-items: center;
}
.npc-config-equip label { color: #ccc; }
.npc-config-equip select {
    background-color: #333;
    color: #fff;
    border: 1px solid #777;
    padding: 5px;
    border-radius: 4px;
    width: 100%;
}
.npc-config-spells {
    max-height: 200px;
    overflow-y: auto;
    background-color: rgba(0,0,0,0.3);
    padding: 10px;
    border-radius: 4px;
}
.spell-checkbox {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 5px;
}

.modal-button-container button.btn-danger {
    background-color: #dc3545;
    color: #fff;
}
.modal-button-container button.btn-danger:hover {
    background-color: #c82333;
}

/* Estilos para Pontos de Ação (PA) */
.pa-dots-container {
    display: flex;
    justify-content: center;
    gap: 4px;
    margin-bottom: 5px;
    height: 10px;
}
.pa-dot {
    width: 10px;
    height: 10px;
    background-color: #ffeb3b;
    border-radius: 50%;
    border: 1px solid #000;
    box-shadow: 0 0 5px #ffeb3b;
}

/* Estilos para o Modal de Debug do GM */
.debug-info-grid {
    display: flex;
    flex-direction: column;
    gap: 8px;
    font-family: monospace;
    font-size: 1.1em;
}
.debug-info-grid h3 {
    color: #fff;
    text-align: center;
}
.debug-info-grid h4 {
    color: #ffc107;
    margin: 10px 0 5px 0;
    border-bottom: 1px solid #555;
    padding-bottom: 4px;
    text-align: left;
}
.debug-info-grid hr {
    width: 100%;
    border: 0;
    border-top: 1px solid #444;
    margin: 5px 0;
}
.debug-info-grid .grid-row {
    display: flex;
    justify-content: space-between;
}
.grid-row span:first-child {
    font-weight: bold;
    color: #ccc;
    padding-right: 15px;
}
.debug-breakdown {
    padding-left: 20px;
    font-size: 0.9em;
    color: #aaa;
    border-left: 2px solid #444;
    margin: 5px 0 5px 10px;
    display: flex;
    flex-direction: column;
    gap: 4px;
}
.breakdown-item {
    display: flex;
    justify-content: space-between;
}
.debug-result {
    font-weight: bold;
    color: #ffeb3b;
}
.final-damage-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 1.3em;
    margin-top: 5px;
}
.debug-final-damage {
    font-weight: bold;
    color: #dc3545;
    font-size: 1.4em;
}
.attacker-name {
    color: #28a745;
    font-weight: bold;
}
.defender-name {
    color: #dc3545;
    font-weight: bold;
}