<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medieval Battle RPG</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="game-wrapper">
    
    <!-- TELA INICIAL DO LOBBY DO GM -->
    <div id="gm-initial-lobby" class="screen active">
        <h1>Lobby do Mestre</h1>
        <p>Envie os links abaixo para os jogadores e espectadores.</p>
        <div class="gm-links-container">
            <div>
                <h3>Link do Jogador (AtÃ© 4):</h3>
                <div id="gm-link-player" class="share-link" title="Clique para copiar">Gerando...</div>
            </div>
            <div>
                <h3>Link de Espectador:</h3>
                <div id="gm-link-spectator" class="share-link" title="Clique para copiar">Gerando...</div>
            </div>
        </div>
        <div id="gm-lobby-status-container">
            <h3>Jogadores Conectados:</h3>
            <ul id="gm-lobby-player-list">
                <li>Aguardando jogadores...</li>
            </ul>
        </div>
        <div class="mode-buttons-container">
            <button id="start-adventure-btn" class="mode-btn">Iniciar Aventura</button>
            <button id="start-theater-btn" class="mode-btn">Modo CenÃ¡rio</button>
        </div>
    </div>
    
    <!-- Tela para o GM confirmar o grupo e definir stats -->
    <div id="gm-party-setup-screen" class="screen">
        <h1>Definir Atributos do Grupo</h1>
        <p>Defina a Agilidade (AGI) e ResistÃªncia (RES) para cada aventureiro.</p>
        <div id="gm-party-list" class="party-list-container"></div>
        <button id="gm-confirm-party-btn" class="mode-btn">Confirmar Grupo e Preparar Inimigos</button>
    </div>

    <!-- Tela para o GM selecionar os NPCs e definir stats -->
    <div id="gm-npc-setup-screen" class="screen">
        <h1>Montar Encontro</h1>
        <p>Clique nos inimigos abaixo para adicionÃ¡-los Ã  batalha (mÃ¡ximo 4).</p>
        <div id="npc-selection-area" class="npc-selection-container"></div>
        <div id="npc-staging-area-container">
            <h3>Inimigos na Batalha:</h3>
            <div id="npc-staging-area"></div>
        </div>
        <button id="gm-start-battle-btn" class="mode-btn">Iniciar Batalha!</button>
    </div>

    <!-- TELA DE ESPERA DO JOGADOR/ESPECTADOR -->
    <div id="player-waiting-screen" class="screen">
         <h1>Medieval Battle RPG</h1>
         <p id="player-waiting-message">Aguardando o Mestre iniciar o jogo...</p>
    </div>
    
    <!-- TELA DE SELEÃ‡ÃƒO DE PERSONAGENS (Para jogadores) -->
    <div id="selection-screen" class="screen">
        <h1 id="selection-title">Selecione seu Aventureiro</h1>
        <div id="character-list-container"></div>
        <button id="confirm-selection-btn">Confirmar</button>
    </div>

    <!-- TELA DE LUTA -->
    <div id="fight-screen" class="screen">
        <div id="fight-scene-characters"></div>
        <div id="turn-order-sidebar" class="hidden"></div>
        <div id="fight-log-container">
            <h2 id="round-info">ROUND 1</h2>
            <div id="fight-log"></div>
        </div>
        <div id="initiative-ui" class="hidden">
            <button id="player-roll-initiative-btn" class="initiative-btn hidden">Rolar Iniciativa</button>
            <button id="gm-roll-initiative-btn" class="initiative-btn hidden">Rolar para Inimigos</button>
        </div>
        <div id="targeting-indicator" class="hidden">Selecione um alvo! (Clique direito ou ESC para cancelar)</div>
        <div id="action-buttons-wrapper"></div>
    </div>

    <!-- MODO CENÃRIO (DO JOGO ANTIGO) -->
    <div id="theater-screen" class="screen">
        <div id="theater-background-viewport">
            <div id="theater-world-container">
                <img id="theater-background-image" src="" alt="CenÃ¡rio do Teatro">
                <div id="theater-token-container"></div>
                <div id="selection-box" class="hidden"></div>
            </div>
        </div>
        <button id="copy-theater-spectator-link" class="copy-link-button hidden" title="Copiar link de espectador">ðŸ”—</button>
        <button id="toggle-gm-panel-btn" class="toggle-gm-panel-btn hidden" title="Mostrar/Ocultar Painel">â˜°</button>
        <div id="theater-gm-panel" class="hidden">
            <div class="panel-section">
                <h4>Personagens</h4>
                <div id="theater-char-list"></div>
            </div>
            <div class="panel-section">
                <h4>Controles Gerais</h4>
                <label for="theater-global-scale">Escala Global:</label>
                <input type="range" id="theater-global-scale" min="0.2" max="3" step="0.1" value="1">
                <button id="theater-change-scenario-btn">Mudar CenÃ¡rio</button>
                <button id="theater-publish-btn" class="hidden">Publicar Cena</button>
            </div>
             <div class="panel-section" id="theater-gm-legend">
                <h4>Atalhos (GM)</h4>
                <p><b>G:</b> SeleÃ§Ã£o em Grupo</p>
                <p><b>F:</b> Virar Personagem</p>
                <p><b>Setas â†‘â†“:</b> Mudar Camada</p>
                <p><b>Delete:</b> Excluir</p>
                <p><b>O (hover):</b> Resetar Tamanho</p>
            </div>
        </div>
        <button id="theater-back-btn" class="back-btn hidden" title="Voltar ao Menu Principal">âŒ‚</button>
    </div>

    <!-- MODAL PADRÃƒO -->
    <div id="modal" class="hidden">
        <div id="modal-content">
            <h3 id="modal-title">TÃ­tulo</h3>
            <div id="modal-text">Texto.</div>
            <button id="modal-button">OK</button>
        </div>
    </div>
    
    <div id="coords-display" class="hidden">X: 0, Y: 0</div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script src="client.js"></script>
</body>
</html>