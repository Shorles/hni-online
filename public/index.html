<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALMARA RPG Online</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="game-wrapper">

    <!-- TELA DE CARREGAMENTO -->
    <div id="loading-screen" class="screen active">
        <h1>ALMARA RPG</h1>
        <p>Conectando ao servidor...</p>
    </div>
    
    <!-- TELA INICIAL DO LOBBY DO GM -->
    <div id="gm-initial-lobby" class="screen">
        <h1>Lobby do Mestre</h1>
        <p>Envie o link de convite para os participantes.</p>
        <div class="gm-links-container">
            <div>
                <h3>Link de Convite:</h3>
                <div id="gm-link-invite" class="share-link" title="Clique para copiar">Gerando...</div>
            </div>
        </div>
        <div id="gm-lobby-status-container">
            <h3>Jogadores Conectados:</h3>
            <ul id="gm-lobby-player-list"></ul>
        </div>
        <div class="mode-buttons-container">
            <button id="start-adventure-btn" class="mode-btn">Iniciar Aventura</button>
            <button id="start-theater-btn" class="mode-btn">Modo Cen√°rio</button>
        </div>
    </div>
    
    <!-- TELA DE ESCOLHA DE PAPEL -->
    <div id="role-selection-screen" class="screen">
        <h1>Bem-vindo!</h1>
        <p>Como voc√™ deseja entrar na sala?</p>
        <div class="mode-buttons-container">
            <button id="join-as-player-btn" class="mode-btn">Jogar</button>
            <button id="join-as-spectator-btn" class="mode-btn">Assistir</button>
        </div>
        <p id="room-full-message" class="hidden" style="margin-top: 20px; color: #ffc107;"></p>
    </div>

    <!-- TELA DE ESPERA DO JOGADOR/ESPECTADOR -->
    <div id="player-waiting-screen" class="screen">
         <h1>ALMARA RPG</h1>
         <p id="player-waiting-message">Aguardando o Mestre iniciar o jogo...</p>
    </div>
    
    <!-- TELA DE SELE√á√ÉO DE PERSONAGEM (NOVO/CARREGAR) -->
    <div id="character-entry-screen" class="screen">
        <h1>Seu Aventureiro</h1>
        <p>Crie um novo personagem ou carregue um j√° existente.</p>
        <div class="mode-buttons-container">
            <button id="new-char-btn" class="mode-btn">Novo Personagem</button>
            <button id="load-char-btn" class="mode-btn">Carregar Personagem</button>
            <input type="file" id="load-char-input" class="hidden" accept=".json">
        </div>
    </div>

    <!-- TELA DE SELE√á√ÉO DE TOKEN -->
    <div id="token-selection-screen" class="screen">
        <h1>Selecione a Apar√™ncia do seu Personagem</h1>
        <div id="token-list-container" class="character-list-container"></div>
        <button id="confirm-token-btn" class="mode-btn" disabled>Confirmar Apar√™ncia</button>
    </div>

    <!-- TELA DE CRIA√á√ÉO DE FICHA -->
    <div id="sheet-creation-screen" class="screen">
        <h1>Cria√ß√£o de Personagem</h1>
        <!-- CORRE√á√ÉO: Estrutura HTML da ficha restaurada -->
        <div class="sheet-form-container">
            <div class="sheet-section"><h3>Identidade</h3><div class="form-grid">
                <div class="form-field"><label for="sheet-name">Nome:</label><input type="text" id="sheet-name"></div>
                <div class="form-field"><label for="sheet-class">Classe:</label><input type="text" id="sheet-class"></div>
            </div></div>
            <div class="sheet-section"><h3>Ra√ßa</h3><div class="form-grid" id="sheet-races"></div></div>
            <div class="sheet-section"><h3>Atributos (<span id="points-to-distribute">0</span> pontos restantes)</h3><div class="form-grid" id="sheet-attributes"></div></div>
            <div class="sheet-section"><h3>Elementos (<span id="element-points-to-distribute">0</span> pontos restantes)</h3><div class="form-grid" id="sheet-elements"></div></div>
            <div class="sheet-section"><h3>Equipamentos (Dinheiro Restante: <span id="money-remaining">200</span> moedas)</h3><div class="form-grid" id="sheet-equipment"></div></div>
            <div class="sheet-section"><h3>Magias (Selecione <span id="spells-to-select">2</span>)</h3><div class="form-grid" id="sheet-spells"></div></div>
        </div>
        <div class="sheet-buttons">
            <button id="save-sheet-btn" class="mode-btn">Salvar Personagem</button>
            <button id="finish-sheet-btn" class="mode-btn">PRONTO</button>
        </div>
    </div>

    <!-- TELA DE PREPARA√á√ÉO DO GM (NPCs) -->
    <div id="gm-npc-setup-screen" class="screen">
        <h1>Montar Encontro</h1>
        <p>Clique em um inimigo da lista para adicionar. Clique em um inimigo na batalha para editar.</p>
        <div class="npc-setup-layout">
            <div id="npc-staging-area">
                <h3>Inimigos na Batalha:</h3>
                <div id="staged-npc-list"></div>
            </div>
            <div class="npc-selection-wrapper">
                <h3>Inimigos Dispon√≠veis:</h3>
                <div id="npc-selection-area"></div>
            </div>
        </div>
        <div id="npc-editor" class="hidden"></div>
        <button id="gm-start-battle-btn" class="mode-btn">Iniciar Batalha!</button>
    </div>

    <!-- TELA DE LUTA -->
    <div id="fight-screen" class="screen">
        <!-- Conte√∫do da tela de luta -->
    </div>

    <!-- MODO CEN√ÅRIO -->
    <div id="theater-screen" class="screen">
        <div id="theater-background-viewport">
            <div id="theater-world-container">
                <img id="theater-background-image" src="" alt="Cen√°rio">
                <div id="theater-token-container"></div>
            </div>
            <div id="selection-box" class="hidden"></div>
        </div>
        <div id="theater-player-controls" class="hidden"></div>
        <button id="toggle-gm-panel-btn" class="toggle-gm-panel-btn hidden" title="Painel do Mestre">‚ò∞</button>
        <div id="theater-gm-panel" class="hidden">
            <div class="panel-section">
                <h4>Personagens</h4>
                <div id="theater-char-list"></div>
            </div>
            <div class="panel-section">
                <h4>Controles Gerais</h4>
                <label for="theater-global-scale">Escala Global:</label>
                <input type="range" id="theater-global-scale" min="0.2" max="3" step="0.1" value="1">
                <button id="theater-change-scenario-btn">Mudar Cen√°rio</button>
                <button id="theater-publish-btn" class="hidden">Publicar Cena</button>
                <button id="theater-lock-players-btn">Bloquear Jogadores</button>
            </div>
             <div class="panel-section" id="theater-gm-legend">
                <h4>Atalhos (GM)</h4>
                <p><b>B:</b> Bloquear/Desbloquear Jogadores</p>
                <p><b>G:</b> Sele√ß√£o em Grupo</p>
                <p><b>F:</b> Virar Personagem</p>
                <p><b>Setas ‚Üë‚Üì:</b> Mudar Camada</p>
                <p><b>Delete:</b> Excluir</p>
                <p><b>O (hover):</b> Resetar Tamanho</p>
                <p><b>Scroll (hover):</b> Mudar Tamanho</p>
            </div>
        </div>
    </div>

    <!-- MODAL PADR√ÉO -->
    <div id="modal" class="hidden">
        <div id="modal-content">
            <h3 id="modal-title">T√≠tulo</h3>
            <div id="modal-text">Texto.</div>
            <button id="modal-button">OK</button>
        </div>
    </div>
    
    <!-- BOT√ïES FLUTUANTES -->
    <button id="back-to-lobby-btn" class="back-btn hidden" title="Voltar ao Lobby">‚åÇ</button>
    <div id="floating-buttons-container" class="hidden">
        <button id="floating-invite-btn" title="Convidar Jogador">‚úâÔ∏è</button>
        <button id="floating-switch-mode-btn" title="Mudar Modo de Jogo">üîÑ</button>
    </div>
    <div id="player-sheet-button" class="floating-btn hidden" title="Ver Ficha">üë§</div>

</div>

<script src="/socket.io/socket.io.js"></script>
<script src="client.js"></script>
</body>
</html>